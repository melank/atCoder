<?php

$GLOBALS['TESTING'] = true;
require_once __DIR__ . '/../main.php';

function runTests(): void {
    // æ‰‹è¨ˆç®—ã§æ¤œè¨¼æ¸ˆã¿ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
    $testCases = [
        [
            'name' => 'åŸºæœ¬ã‚±ãƒ¼ã‚¹: 4ã¤ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ',
            'input' => [1, 100, 3001, 3002],
            'expected' => [1, 2, 3, 3],
            // t=1: [1] -> 1å€‹
            // t=100: [1,100] -> 2å€‹
            // t=3001: [1,100,3001] -> 3å€‹ (ç¯„å›²[1,3001])
            // t=3002: [100,3001,3002] -> 3å€‹ (ç¯„å›²[2,3002], t=1ã¯ç¯„å›²å¤–)
        ],
        [
            'name' => 'å˜ä¸€ãƒªã‚¯ã‚¨ã‚¹ãƒˆ',
            'input' => [1000000000],
            'expected' => [1],
            // ãƒªã‚¯ã‚¨ã‚¹ãƒˆ1ã¤ã ã‘ãªã®ã§å¸¸ã«1
        ],
        [
            'name' => 'ç­‰é–“éš”ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆ1000msé–“éš”ï¼‰',
            'input' => [1000, 2000, 3000, 4000, 5000],
            'expected' => [1, 2, 3, 4, 4],
            // t=1000: [1000] -> 1å€‹
            // t=2000: [1000,2000] -> 2å€‹
            // t=3000: [1000,2000,3000] -> 3å€‹
            // t=4000: [1000,2000,3000,4000] -> 4å€‹ (ç¯„å›²[1000,4000], 1000å«ã‚€)
            // t=5000: [2000,3000,4000,5000] -> 4å€‹ (ç¯„å›²[2000,5000], 1000ã¯ç¯„å›²å¤–)
        ],
        [
            'name' => 'åŒæ™‚åˆ»ã®è¤‡æ•°ãƒªã‚¯ã‚¨ã‚¹ãƒˆ',
            'input' => [100, 100, 100],
            'expected' => [1, 2, 3],
            // ã™ã¹ã¦åŒã˜æ™‚åˆ»ãªã®ã§ç´¯ç©çš„ã«å¢—ãˆã‚‹
        ],
        [
            'name' => 'å¤§ããé›¢ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆ',
            'input' => [1, 5000, 10000, 15000],
            'expected' => [1, 1, 1, 1],
            // å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒ3000msä»¥ä¸Šé›¢ã‚Œã¦ã„ã‚‹ã®ã§å¸¸ã«1
        ],
        [
            'name' => 'ã¡ã‚‡ã†ã©3000mså·®',
            'input' => [0, 3000, 6000],
            'expected' => [1, 2, 2],
            // t=0: [0] -> 1å€‹
            // t=3000: [0,3000] -> 2å€‹ (ç¯„å›²[0,3000], 0å«ã‚€)
            // t=6000: [3000,6000] -> 2å€‹ (ç¯„å›²[3000,6000], 0ã¯ç¯„å›²å¤–)
        ],
        [
            'name' => 'é€£ç¶šã—ãŸçŸ­ã„é–“éš”',
            'input' => [1, 2, 3, 4, 5],
            'expected' => [1, 2, 3, 4, 5],
            // ã™ã¹ã¦3000msä»¥å†…ãªã®ã§ç´¯ç©
        ],
        [
            'name' => '3001mså·®ï¼ˆå¢ƒç•Œãƒ†ã‚¹ãƒˆï¼‰',
            'input' => [0, 3001],
            'expected' => [1, 1],
            // t=0: [0] -> 1å€‹
            // t=3001: [3001] -> 1å€‹ (ç¯„å›²[1,3001], 0ã¯ç¯„å›²å¤–)
        ],
        [
            'name' => 'è¤‡é›‘ãªã‚±ãƒ¼ã‚¹',
            'input' => [1, 1000, 2000, 3001, 4000, 4500, 7000, 7500],
            'expected' => [1, 2, 3, 4, 4, 4, 3, 3],
            // t=1: ç¯„å›²[-2999,1] -> [1] -> 1å€‹
            // t=1000: ç¯„å›²[-2000,1000] -> [1,1000] -> 2å€‹
            // t=2000: ç¯„å›²[-1000,2000] -> [1,1000,2000] -> 3å€‹
            // t=3001: ç¯„å›²[1,3001] -> [1,1000,2000,3001] -> 4å€‹
            // t=4000: ç¯„å›²[1000,4000] -> [1000,2000,3001,4000] -> 4å€‹ (1ã¯ç¯„å›²å¤–)
            // t=4500: ç¯„å›²[1500,4500] -> [2000,3001,4000,4500] -> 4å€‹ (1000ã¯ç¯„å›²å¤–)
            // t=7000: ç¯„å›²[4000,7000] -> [4000,4500,7000] -> 3å€‹ (3001ã¯ç¯„å›²å¤–)
            // t=7500: ç¯„å›²[4500,7500] -> [4500,7000,7500] -> 3å€‹ (4000ã¯ç¯„å›²å¤–)
        ],
        [
            'name' => '2ã¤ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆç¯„å›²å†…ï¼‰',
            'input' => [500, 2500],
            'expected' => [1, 2],
            // t=500: [500] -> 1å€‹
            // t=2500: [500,2500] -> 2å€‹ (ç¯„å›²[-500,2500])
        ],
    ];

    $passed = 0;
    $failed = 0;

    echo "=== æœ€è¿‘ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•° ãƒ†ã‚¹ãƒˆ ===\n\n";

    foreach ($testCases as $testCase) {
        $result = solution($testCase['input']);
        $isPass = $result === $testCase['expected'];

        if ($isPass) {
            echo "âœ… PASS: {$testCase['name']}\n";
            $passed++;
        } else {
            echo "âŒ FAIL: {$testCase['name']}\n";
            echo "   å…¥åŠ›: [" . implode(', ', $testCase['input']) . "]\n";
            echo "   æœŸå¾…å€¤: [" . implode(', ', $testCase['expected']) . "]\n";
            echo "   å®Ÿéš›ã®å€¤: [" . implode(', ', $result) . "]\n";
            $failed++;
        }
    }

    echo "\n=== çµæœ ===\n";
    echo "åˆè¨ˆ: " . count($testCases) . " ãƒ†ã‚¹ãƒˆ\n";
    echo "æˆåŠŸ: {$passed}\n";
    echo "å¤±æ•—: {$failed}\n";

    if ($failed === 0) {
        echo "\nğŸ‰ ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã«åˆæ ¼ã—ã¾ã—ãŸï¼\n";
    } else {
        echo "\nâš ï¸  {$failed} å€‹ã®ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¦ã„ã¾ã™ã€‚\n";
    }
}

runTests();
